---
title: ''
output:
  bookdown::html_document2:
    fig_width: 6
    fig_height: 4
    number_sections: no
    self_contained: no
    df_print: default
    fig_caption: yes
    smart: no
  word_document:
    toc_depth: 2
    fig_caption: yes
---


<style type="text/css">
  body{
  font-size: 12pt;
}
</style>

```{r addimg function, include=FALSE}
library(png)
addImg <- function(obj, x = NULL, y = NULL, width = NULL, interpolate = TRUE){
  if(is.null(x) | is.null(y) | is.null(width)){stop("Must provide args 'x', 'y', and 'width'")}
  USR <- par()$usr ; PIN <- par()$pin ; DIM <- dim(obj) ; ARp <- DIM[1]/DIM[2]
  WIDi <- width/(USR[2]-USR[1])*PIN[1] ;   HEIi <- WIDi * ARp 
  HEIu <- HEIi/PIN[2]*(USR[4]-USR[3]) 
  rasterImage(image = obj, xleft = x-(width/2), xright = x+(width/2),
            ybottom = y-(HEIu/2), ytop = y+(HEIu/2), interpolate = interpolate)
}
logo <- readPNG("2015-UWA-Full-Hor-CMYK-png.png") # add our own image
```

```{r save-default-par, include=FALSE}
defpar <- par(no.readonly = TRUE)
```

```{r header-image, echo=FALSE, fig.height=3, fig.width=20, message=FALSE, warning=FALSE}
par(mar=c(0,0,0,0))
windowsFonts(uwa = windowsFont("UWA"))
plot(c(0,1),type="n",axes=F,bty="n",xlab="",ylab="",xaxs="i",yaxs="i")
rect(1.25, 0.9, 2, 1, col="#003087", border="#003087")
rect(1.8, 0.9, 2, 1, col="#DAAA00", border="#DAAA00")
addImg(logo, x = 1.11, y = 0.6, width = 0.2)
text(1.95,0.75,pos=2,labels="School of Agriculture and Environment", cex=3,
     family="uwa", col="#003087")
text(1.95,0.6,pos=2,labels="\u2514 Environmental Science", cex=3,
     family="uwa", col="#003087")
par(mar = c(3.5,3.5,0.5,0.5), font.lab=2, mgp=c(1.6,0.3,0), tcl=0.25, 
    lend="square", ljoin="mitre")
```

The up-to-date code to generate this document is always available at 
[https://github.com/Ratey-AtUWA/Learn-R/raw/main/Why-UWAcolgrad.Rmd](https://github.com/Ratey-AtUWA/Learn-R/raw/main/Why-UWAcolgrad.Rmd){target="_blank"}.

# Why a UWA colour palette generator for **R**?

Colour palettes with relatively few distinctive colours are often used in the
corporate world. Apparently they confer a consistent "look and feel" to
company-branded materials, making publications, presentations, and advertising
more memorable and the brand more recognisable.

When presenting material clearly from a scientific perspective, however,
corporate colour palettes can be problematic if they include colour combinations
that are difficult to distinguish for people having colour vision impairments
such as red-green colour-blindness. Where colour comparisons are important to
interpreting data presented graphically, the contrast between the items being
compared should be visible to as many people as possible, regardless of
colour-blindness. In addition, the print copies of some scientific journals
still reproduce figures as greyscale images, so a colour palette that maintains
as much contrast as possible when converted to greyscale is preferable. This is
achieved with:

1. a *uniform gradient*, an approximately linear relationship between greyscale value and colour palette index;
2. a wide range of initial contrast (dark to light, or *vice versa*).

The importance of contrast when converting to greyscale is illustrated by the 
four versions of the same map shown in Figure \@ref(fig:recoloured-map) below.

```{r recoloured-map, echo=FALSE, fig.height=6.25, fig.width=10, message=FALSE, warning=FALSE, fig.align='center', fig.cap="Four versions of the same map: (a) original colours from Thebo *et al*. (2014); (b) original map converted to grayscale; (c) recoloured map used in Rate (2022); (d) recoloured map converted to grayscale.", echo=FALSE}
logo <- readPNG("recoloured-map.png") # add our own image
par(mar=c(0,0,0,0))
plot(c(0,1),type="n",axes=F,bty="n",xlab="",ylab="",xaxs="i",yaxs="i")
addImg(logo, x = 1.5, y = 0.5, width = 1)
par(mar = c(3.5,3.5,0.5,0.5), font.lab=2, mgp=c(1.6,0.3,0), tcl=0.25, 
    lend="square", ljoin="mitre")
```

<p>&nbsp;</p>

Fortunately for staff and students working at UWA, the standard blue and gold colours in the
[UWA brand](https://www.uniprint.uwa.edu.au/answers/visual-identity/what-colours-do-I-need-to-use-to-comply-with-the-uwa-brand){target="_blank"} lend themselves well to generation of themed colour palettes which are
colourblind-friendly. The development of a possible UWA colour palette with
uniform colour gradient is discussed below.

## 1. Existing palettes available in **R** packages

There are several existing **R** packages and functions which allow generation
of uniform-gradient, colourblind-friendly palettes.

### 1.1 RColorBrewer

The `RColorBrewer` package (Neuwirth, 2022) contains 35 in-built palettes, 27 of
which are colourblind-friendly (Figure \@ref(fig:rcolorbrewer-cbf)).

```{r rcolorbrewer-cbf, fig.height=8, fig.width=8, message=FALSE, warning=FALSE, fig.align='center', fig.cap="Colourblind-friendly palettes from the `RColorBrewer` R package. Each palette is shown with the maximum allowable number of colours.", results='hold', echo=2:3}
par(mar=c(0,4,0,0))
library(RColorBrewer)
display.brewer.all(colorblindFriendly = TRUE)
text(c(2,2,2),c(29.3,10.3,6.3),pos=2,font=2,
     labels=c("Gradational","Qualitative","Diverging"))
par(mar = c(3.5,3.5,0.5,0.5), font.lab=2, mgp=c(1.6,0.3,0), tcl=0.25, 
    lend="square", ljoin="mitre")
```

<p>&nbsp;</p>

For comparison, the `RColorBrewer` colourblind-friendly palettes viewed in 
greyscale are shown below (Figure \@ref(fig:rcolorbrewer-gray):

```{r rcolorbrewer-gray, echo=FALSE, fig.height=6, fig.width=6, message=FALSE, warning=FALSE, fig.align='center', fig.cap="Colourblind-friendly palettes from the `RColorBrewer` R package, shown as a greyscale image.", echo=FALSE}
logo <- readPNG("rcolorbrewer-gray.png") # add our own image
par(mar=c(0,0,0,0))
plot(c(0,1),type="n",axes=F,bty="n",xlab="",ylab="",xaxs="i",yaxs="i")
addImg(logo, x = 1.5, y = 0.5, width = 1)
par(mar = c(3.5,3.5,0.5,0.5), font.lab=2, mgp=c(1.6,0.3,0), tcl=0.25, 
    lend="square", ljoin="mitre")
```

<p>&nbsp;</p>

## References

Garnier S, Ross N, Rudis R, Camargo AP, Sciaini M, Scherer C (2021). *Rvision - Colorblind-Friendly Color Maps for R*. R package version 0.6.2. (package **viridis**) [https://sjmgarnier.github.io/viridis/](https://sjmgarnier.github.io/viridis/){target="_blank"}

Neuwirth E (2022). *RColorBrewer: ColorBrewer Palettes*. R package version 1.1-3, [https://CRAN.R-project.org/package=RColorBrewer](https://CRAN.R-project.org/package=RColorBrewer){target="_blank"}.

Pedersen T, Crameri F (2023). *scico: Colour Palettes Based on the Scientific Colour-Maps*. R package version 1.4.0, [https://CRAN.R-project.org/package=scico](https://CRAN.R-project.org/package=scico){target="_blank"}

Rate, A.W. (2022). Urban Ecosystems: Soils and the Rise and Fall of Cities. **In** Rate, A.W. (Ed.), *Urban Soils: Principles and Practice*. Springer-Nature; Cham, Switzerland. [https://doi.org/10.1007/978-3-030-87316-5](https://doi.org/10.1007/978-3-030-87316-5){target="_blank"}. 

Thebo, A. L., Drechsel, P., & Lambin, E. F. (2014). Global assessment of urban and peri-urban agriculture: irrigated and rainfed croplands. *Environmental Research Letters*, **9**, 9pp. [https://doi.org/10.1088/1748-9326/9/11/114002](https://doi.org/10.1088/1748-9326/9/11/114002){target="_blank"} 

